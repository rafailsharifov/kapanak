<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Kapanak">
    <meta name="description" content="Simple spaced repetition flashcards for language learning">

    <title>Kapanak - Flashcards</title>

    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <h1 class="logo" id="logo-btn">ü¶ã Kapanak</h1>
            <button id="settings-btn" class="icon-btn" aria-label="Settings">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
            </button>
        </header>

        <!-- Main Content -->
        <main class="main">
            <!-- Home Screen -->
            <section id="home-screen" class="screen active">
                <!-- Stats Dashboard -->
                <div class="dashboard">
                    <div class="streak-banner" id="streak-banner">
                        <span class="streak-icon">üî•</span>
                        <span class="streak-text" id="streak-text">0 day streak</span>
                    </div>

                    <div class="progress-card">
                        <div class="progress-label">
                            <span>Mastered</span>
                            <span id="mastered-percent">0%</span>
                        </div>
                        <div class="mastery-bar">
                            <div class="mastery-fill" id="mastery-fill"></div>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-box">
                            <span class="stat-number" id="due-count">0</span>
                            <span class="stat-label">Due</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-number" id="total-count">0</span>
                            <span class="stat-label">Total</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-number" id="today-reviewed">0</span>
                            <span class="stat-label">Today</span>
                        </div>
                    </div>
                </div>

                <!-- Swap Toggle -->
                <div class="swap-toggle-home">
                    <span class="swap-label" id="swap-label">Front ‚Üí Back</span>
                    <label class="toggle">
                        <input type="checkbox" id="swap-toggle">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="home-actions">
                    <button id="study-btn" class="btn btn-primary btn-large btn-gradient">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="5 3 19 12 5 21 5 3"></polygon>
                        </svg>
                        Study Due
                    </button>
                    <div class="btn-row">
                        <button id="practice-btn" class="btn btn-secondary">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            </svg>
                            Practice All
                        </button>
                        <button id="import-btn" class="btn btn-secondary">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            Import
                        </button>
                    </div>
                </div>
            </section>

            <!-- Study Screen -->
            <section id="study-screen" class="screen">
                <div class="study-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <span class="progress-text" id="progress-text">0 / 0</span>
                </div>

                <div class="flashcard-container" id="flashcard-container">
                    <div class="flashcard" id="flashcard">
                        <div class="card-face card-face-front" id="card-front"></div>
                        <div class="card-face card-face-back" id="card-back"></div>
                    </div>
                    <p class="tap-hint" id="tap-hint">Tap to flip</p>
                    <p class="swipe-hint">‚Üê Again ¬∑ Good ‚Üí ¬∑ Easy ‚Üë</p>
                </div>

                <div class="review-buttons hidden" id="review-buttons">
                    <button class="btn btn-again" data-rating="0">
                        <span class="btn-label">Again</span>
                        <span class="btn-hint">&lt;1min</span>
                    </button>
                    <button class="btn btn-good" data-rating="3">
                        <span class="btn-label">Good</span>
                        <span class="btn-hint" id="good-hint"></span>
                    </button>
                    <button class="btn btn-easy" data-rating="5">
                        <span class="btn-label">Easy</span>
                        <span class="btn-hint" id="easy-hint"></span>
                    </button>
                </div>

                <div class="study-actions">
                    <button id="undo-btn" class="btn btn-text" disabled>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 7v6h6"></path>
                            <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6.36 2.64L3 13"></path>
                        </svg>
                        Undo
                    </button>
                    <button id="end-study-btn" class="btn btn-text">End Session</button>
                </div>
            </section>

            <!-- Study Complete Screen -->
            <section id="complete-screen" class="screen">
                <div class="complete-content">
                    <div class="complete-icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                    </div>
                    <h2>Session Complete!</h2>
                    <p class="complete-stats" id="complete-stats"></p>
                    <button id="back-home-btn" class="btn btn-primary">Back to Home</button>
                </div>
            </section>

            <!-- Import Screen -->
            <section id="import-screen" class="screen">
                <div class="import-header">
                    <button id="import-back-btn" class="btn btn-text">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        Back
                    </button>
                    <h2>Import Cards</h2>
                </div>

                <div class="import-instructions">
                    <p>Enter one card per line. Use a comma to separate front and back:</p>
                    <code>kot,cat</code>
                    <code>Jak siƒô masz?,How are you?</code>
                </div>

                <textarea id="import-textarea" placeholder="kot,cat&#10;pies,dog&#10;Jak siƒô nazywasz?,What is your name?"></textarea>

                <div class="import-actions">
                    <span class="import-preview" id="import-preview"></span>
                    <button id="import-submit-btn" class="btn btn-primary" disabled>Import Cards</button>
                </div>
            </section>

            <!-- Manage Cards Screen -->
            <section id="manage-screen" class="screen">
                <div class="manage-header">
                    <button id="manage-back-btn" class="btn btn-text">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        Back
                    </button>
                    <h2>Manage Cards</h2>
                </div>

                <div class="card-list" id="card-list">
                    <!-- Cards will be populated here -->
                </div>

                <div class="empty-state hidden" id="empty-state">
                    <p>No cards yet. Import some cards to get started!</p>
                </div>

                <!-- Edit Card Modal -->
                <div class="modal hidden" id="edit-modal">
                    <div class="modal-content">
                        <h3>Edit Card</h3>
                        <input type="hidden" id="edit-card-id">
                        <div class="form-group">
                            <label for="edit-front">Front</label>
                            <input type="text" id="edit-front" placeholder="Front side">
                        </div>
                        <div class="form-group">
                            <label for="edit-back">Back</label>
                            <input type="text" id="edit-back" placeholder="Back side">
                        </div>
                        <div class="modal-actions">
                            <button id="edit-cancel-btn" class="btn btn-secondary">Cancel</button>
                            <button id="edit-save-btn" class="btn btn-primary">Save</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Settings Screen -->
            <section id="settings-screen" class="screen">
                <div class="settings-header">
                    <button id="settings-back-btn" class="btn btn-text">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        Back
                    </button>
                    <h2>Settings</h2>
                </div>

                <div class="settings-section">
                    <h3>Cards</h3>
                    <button id="manage-btn" class="btn btn-secondary btn-full">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="8" y1="6" x2="21" y2="6"></line>
                            <line x1="8" y1="12" x2="21" y2="12"></line>
                            <line x1="8" y1="18" x2="21" y2="18"></line>
                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                        </svg>
                        Manage Cards
                    </button>
                </div>

                <div class="settings-section">
                    <h3>Appearance</h3>
                    <div class="setting-item">
                        <span>Dark Mode</span>
                        <label class="toggle">
                            <input type="checkbox" id="dark-mode-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Data</h3>
                    <button id="export-btn" class="btn btn-secondary btn-full">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Export Backup (JSON)
                    </button>
                    <button id="import-backup-btn" class="btn btn-secondary btn-full">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        Restore Backup
                    </button>
                    <input type="file" id="backup-file-input" accept=".json" hidden>
                </div>

                <div class="settings-section danger-zone">
                    <h3>Danger Zone</h3>
                    <button id="delete-all-btn" class="btn btn-danger btn-full">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                        Delete All Data
                    </button>
                </div>

                <div class="settings-footer">
                    <p id="app-version">Kapanak</p>
                    <p>All data stored locally on your device.</p>
                </div>
            </section>
        </main>

        <!-- Toast Notifications -->
        <div id="toast" class="toast"></div>
    </div>

    <!-- Dexie.js for IndexedDB -->
    <script src="https://unpkg.com/dexie@3.2.4/dist/dexie.min.js"></script>

    <!-- App Scripts -->
    <script src="js/version.js"></script>
    <script src="js/db.js"></script>
    <script src="js/sm2.js"></script>
    <script src="js/import.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
